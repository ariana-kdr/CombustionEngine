clear variables;
data = readtable('AnaMeDa_2022_group03.xlsx');
%% EDA - Statistics

x = data.Dissolution;

length_x = length(x); 
min_x = min(x);
max_x = max(x);
range_x = range(x);
mean_x = mean(x);
median_x = median(x);
std_x = std(x);
var_x = var(x);
iqr_x = iqr(x);
%% EDA - Visualisation

% Time sequence plot
figure 
hold on
title('Time sequence plot')
xlabel('Index');
ylabel('Dissolution'); 
grid on;
plot(x,'.')
hold off

% Histogram (not super useful)
figure
hold on
title('Histogram')
xlabel('Dissolution');
ylabel('Frequency'); 
grid on;
histogram(x)
hold off

% Density trace - different graphs obtained for different
% bandwidths, so first verify that experimental data is correct
figure
hold on
title('Density trace')
xlabel('Dissolution');
ylabel('Density'); 
grid on;
ksdensity(x)
hold off

% Boxplot
figure
hold on
title('Boxplot')
xlabel('Dissolution');
ylim([63 82]);
grid on;
boxplot(x)
hold off

% density trace shows graph similar to normal distribution 
% when no bandwidth set

% boxplot shows fairly symmetric distrubtion excluding a few
% outliers
%% Probability Distribution (68%)

% 68%-confidence interval
Smean_x = std_x / (sqrt(length_x));

%Computing Y
y = x ./ (100-x);
length_y = length(y);
mean_y = mean(y);
std_y = std(y);
%Method 1 for 68%
Smean_y = std_y / (sqrt(length_y));
%Method 2 for 68%
y_bar = mean_x ./ (100-mean_x);
partial_yxmean = (100)/(100-mean_x)^2;
Smean_y2 = (partial_yxmean * Smean_x);

%% Task 2

Force = data.Force;
CoatingViscosity = data.CoatingViscosity;
TempInlet = data.TempInlet;
TempExhaust = data.TempExhaust;
SprayRate = data.SprayRate;
Dissolution = data.Dissolution;

corrF = corr([Force,Dissolution]); %No option
corrV = corr([CoatingViscosity,Dissolution]); %Not terrible
corrTi = corr([TempInlet,Dissolution]); %No option at all
corrTe = corr([TempExhaust,Dissolution]); %No option
corrS = corr([SprayRate,Dissolution]); %Best correlation

figure
hold on
scatter(SprayRate,Dissolution);
ylabel({'Dissolution fraction'});
xlabel({'Spray rate'});
title({'Scatter plot'});
hold off

Smean_spray = std(SprayRate) ./ sqrt(length_x);
